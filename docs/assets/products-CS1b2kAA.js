import{s as C}from"./supabase-530oTR8b.js";import{N as z}from"./front-page-navbar-D7c4QwtM.js";import{V as M}from"./VAlert-3engY8ay.js";import{a as D,V as F}from"./VRow-B1K7SWk7.js";import{V as W,a as H,b as J,c as K}from"./VCard-DSA5d7tx.js";import{V as q}from"./VImg-BuNpeMJc.js";import{V as O}from"./VDivider-PwI-pKnj.js";import{V as g}from"./VCardText-esC-nFTL.js";import{b as S}from"./VTextField-l-OaS9z9.js";import{r as p,W as E,D as Y,c as u,o as d,b as l,d as s,f as N,l as Z,e as o,s as f,t as n,F as y,h as T,Z as h,Y as $,m as G,v as Q}from"./index-qeOE-RZf.js";import{V as X}from"./VChip-D0U8pgGv.js";import{V as ee}from"./VSpacer-_ceUCEQo.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VNodeRenderer-2Xb0beZ3.js";import"./vue3-perfect-scrollbar-JJAVp85z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VAvatar-CrC7-P1Q.js";import"./VNavigationDrawer-3eveQODF.js";import"./scopeId-Caf1NDu8.js";import"./ssrBoot-DzfblIhC.js";/* empty css              */import"./forwardRefs-DWGaNmQL.js";const te={class:"max-w-5xl mx-auto py-8 px-4 mt-16"},ae={class:"d-flex justify-space-between flex-wrap flex-md-nowrap flex-column flex-md-row"},se={class:"ma-auto pa-5"},le={class:"flex-grow-1"},oe={class:"font-weight-medium"},re={class:"text-xs text-gray-400"},ne={class:"flex items-center gap-2 w-full md:w-auto"},ie={class:"flex flex-col items-end md:items-center md:flex-row gap-1 md:gap-4 w-full md:w-auto"},de={key:1,class:"mb-10"},ce={class:"border rounded"},me={class:"d-flex w-100 flex-column flex-md-row"},ue={class:"d-flex flex-column gap-y-2"},fe={class:"text-h6"},pe={class:"d-flex align-center text-no-wrap gap-4 text-body-1"},_e={class:"text-disabled"},ve={class:"d-inline-block text-primary"},xe={class:"d-flex flex-column mt-5 text-start text-md-end gap-2"},ge={class:"d-flex text-base align-self-md-end gap-2"},ye={class:"text-primary font-bold"},he={class:"flex justify-end items-center gap-4 mt-4"},be={class:"font-bold text-lg"},ke={key:2,class:"text-center text-gray-400"},Ke={__name:"products",setup(Ve){const b=p([]),_=p(""),c=p({}),r=p([]),v=p(""),A=async()=>{_.value="";const{data:t,error:a}=await C.from("products").select("*, product_images(image_url, is_primary)").gt("stock",0).order("created_at",{ascending:!1});if(a){_.value=a.message;return}b.value=t.map(e=>{var i,m,V,w;return{...e,primary_image:((m=(i=e.product_images)==null?void 0:i.find(U=>U.is_primary))==null?void 0:m.image_url)||((w=(V=e.product_images)==null?void 0:V[0])==null?void 0:w.image_url)||null}})},I=async()=>{const{data:t,error:a}=await C.from("content").select("value").eq("section","contact").eq("key","wa").single();!a&&t&&(v.value=t.value)},P=t=>{const a=Number(c.value[t.id])||1;if(a<1||a>t.stock)return;const e=r.value.findIndex(i=>i.id===t.id);e!==-1?r.value[e].qty=Math.min(r.value[e].qty+a,t.stock):r.value.push({id:t.id,name:t.name,price:t.price,stock:t.stock,primary_image:t.primary_image,qty:a}),c.value[t.id]=1,x()},R=t=>{t.qty<1&&(t.qty=1),t.qty>t.stock&&(t.qty=t.stock),x()},j=t=>{r.value=r.value.filter(a=>a.id!==t),x()},k=E(()=>r.value.reduce((t,a)=>t+a.price*a.qty,0)),x=()=>{localStorage.setItem("front_cart",JSON.stringify(r.value))},B=()=>{const t=localStorage.getItem("front_cart");t&&(r.value=JSON.parse(t))},L=()=>{if(!v.value)return;let t=`Hello, I would like to order:
`;r.value.forEach(e=>{t+=`- ${e.name} x${e.qty} (Rp ${e.price.toLocaleString()} each)
`}),t+=`Total: Rp ${k.value.toLocaleString()}
`,t+=`
Please contact me for further details.`;const a=`https://wa.me/${v.value}?text=${encodeURIComponent(t)}`;window.open(a,"_blank")};return Y(()=>{A(),B(),I()}),(t,a)=>(d(),u(y,null,[l(z,{"active-id":"Produk"}),s("div",te,[a[5]||(a[5]=s("h1",{class:"text-3xl font-bold mb-6 text-center"},"Produk Kami",-1)),_.value?(d(),N(M,{key:0,type:"error",class:"mb-4"},{default:o(()=>[f(n(_.value),1)]),_:1})):Z("",!0),l(F,{class:"mb-10",dense:""},{default:o(()=>[(d(!0),u(y,null,T(b.value,e=>(d(),N(D,{key:e.id,sm:"6",cols:"12"},{default:o(()=>[l(W,null,{default:o(()=>[s("div",ae,[s("div",se,[l(q,{width:"137",height:"176",src:e.primary_image,alt:"Product image",class:"rounded"},null,8,["src"])]),l(O,{vertical:t.$vuetify.display.mdAndUp},null,8,["vertical"]),s("div",le,[l(H,null,{default:o(()=>[l(J,null,{default:o(()=>[f(n(e.name),1)]),_:2},1024)]),_:2},1024),l(g,null,{default:o(()=>[f(n(e.description),1)]),_:2},1024),l(g,{class:"text-subtitle-1"},{default:o(()=>[a[0]||(a[0]=s("span",null,"Harga: ",-1)),s("span",oe,"Rp "+n(e.price.toLocaleString()),1)]),_:2},1024),l(g,{class:"text-subtitle-1"},{default:o(()=>[s("span",re,"Stok: "+n(e.stock),1)]),_:2},1024),l(K,{class:"justify-space-between flex-col md:flex-row gap-2 md:gap-0"},{default:o(()=>[s("div",ne,[l(S,{modelValue:c.value[e.id],"onUpdate:modelValue":i=>c.value[e.id]=i,modelModifiers:{number:!0},type:"number",min:"1",max:e.stock,density:"compact","hide-details":"",style:{width:"90px"},disabled:e.stock===0,label:"Jumlah",class:"bg-gray-50 rounded"},null,8,["modelValue","onUpdate:modelValue","max","disabled"])]),s("div",ie,[l(h,{color:"primary",size:"small",class:"font-semibold",disabled:e.stock===0||!c.value[e.id]||c.value[e.id]<1,onClick:i=>P(e),style:{"min-width":"160px"},variant:"tonal"},{default:o(()=>[l($,{icon:"tabler-shopping-cart-plus"}),a[1]||(a[1]=s("span",{class:"ms-2"},"Tambah ke keranjang",-1))]),_:2},1032,["disabled","onClick"])])]),_:2},1024)])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),r.value.length?(d(),u("div",de,[a[4]||(a[4]=s("h2",{class:"text-xl font-bold mb-4"},"Keranjang Anda",-1)),s("div",ce,[(d(!0),u(y,null,T(r.value,(e,i)=>(d(),u("div",{key:e.id,class:Q(["d-flex align-center gap-4 pa-6 position-relative flex-column flex-sm-row",i?"border-t":""])},[l(h,{icon:"",onClick:m=>j(e.id),title:"Delete",color:"error",variant:"tonal"},{default:o(()=>[l($,{icon:"tabler-trash"})]),_:2},1032,["onClick"]),s("div",null,[l(q,{width:"140",height:"100",src:e.primary_image,alt:"Product image",class:"rounded"},null,8,["src"])]),s("div",me,[s("div",ue,[s("h6",fe,n(e.name),1),s("div",pe,[s("div",_e,[a[2]||(a[2]=f(" Stok: ")),s("span",ve,n(e.stock),1)]),l(X,{color:e.stock>0?"success":"error",label:"",size:"small"},{default:o(()=>[f(n(e.stock>0?"Tersedia":"Habis"),1)]),_:2},1032,["color"])]),l(S,{modelValue:e.qty,"onUpdate:modelValue":m=>e.qty=m,modelModifiers:{number:!0},type:"number",min:"1",max:e.stock,style:{"inline-size":"9.375rem"},density:"compact","hide-details":"",onChange:m=>R(e)},null,8,["modelValue","onUpdate:modelValue","max","onChange"])]),l(ee),s("div",xe,[s("div",ge,[s("div",ye," Rp "+n(e.price.toLocaleString()),1)])])])],2))),128))]),s("div",he,[s("div",be,"Total: Rp "+n(G(k).toLocaleString()),1),l(h,{color:"success",size:"large",onClick:L,variant:"tonal"},{default:o(()=>a[3]||(a[3]=[f(" Pesan lewat WhatsApp ")])),_:1})])])):(d(),u("div",ke,"Keranjang Anda kosong."))])],64))}};export{Ke as default};
