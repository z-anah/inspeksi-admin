import{_ as T}from"./AppTextarea-D4i3yqbr.js";import{_ as w}from"./AppTextField-S2iDxnhT.js";import{i as U,j as h,r as f,b3 as q,D as B,c as V,o as p,b as a,e as r,t as i,v as x,f as P,m as $,a1 as D,d as C,F,h as N,Z as c,Y as S,n as E}from"./index-C_Fo-Q1Z.js";import{s as b}from"./supabase-dF8vZqmp.js";import{b as M,c as R,V as j}from"./VCard-DIix0bcz.js";import{V as I}from"./VCardText-oi22yba3.js";import{V as L}from"./VAlert-Cp-4rYs2.js";import{V as z}from"./VForm-BeUWgbEy.js";import{V as O}from"./VSpacer-_k1Z9FJN.js";import"./VTextField-B25NbKOl.js";import"./VImg-BUi6ipbq.js";import"./forwardRefs-DWGaNmQL.js";import"./VTextarea-kPssa-L-.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VAvatar-C3GauEvc.js";/* empty css              */const Y={class:"p-6 max-w-2xl mx-auto"},Z={class:"mb-4"},de={__name:"[id]",setup(G){const v=U(),_=h(),n=f(!1),s=f(""),u=f(v.params.id!=="new"),e=q({id:null,type:"",title:"",published_at:"",image_url:"",content:[]}),k=async()=>{if(!u.value)return;n.value=!0,s.value="";const{data:l,error:t}=await b.from("articles").select("*").eq("id",v.params.id).single();t?s.value=t.message:Object.assign(e,{...l,content:Array.isArray(l.content)?l.content:l.content?[l.content]:[]}),n.value=!1},g=async()=>{if(!e.type||!e.title||!e.published_at||!e.content.length){s.value="Type, Title, Published Date, and Content are required";return}n.value=!0,s.value="";let l;u.value?l=await b.from("articles").update({type:e.type,title:e.title,published_at:e.published_at,image_url:e.image_url,content:e.content}).eq("id",e.id).select():l=await b.from("articles").insert([{type:e.type,title:e.title,published_at:e.published_at,image_url:e.image_url,content:e.content}]).select(),l.error?s.value=l.error.message:_.push({name:"admin-articles"}),n.value=!1};return B(()=>{u.value&&k()}),(l,t)=>{const d=w,A=T;return p(),V("div",Y,[a(j,null,{default:r(()=>[a(M,null,{default:r(()=>[i(x(u.value?"Edit Article":"Add Article"),1)]),_:1}),a(I,null,{default:r(()=>[s.value?(p(),P(L,{key:0,type:"error",class:"mb-4"},{default:r(()=>[i(x(s.value),1)]),_:1})):$("",!0),a(z,{onSubmit:D(g,["prevent"])},{default:r(()=>[a(d,{modelValue:e.type,"onUpdate:modelValue":t[0]||(t[0]=o=>e.type=o),label:"Type (e.g. opini, kisah, rilis)",required:"",class:"mb-4"},null,8,["modelValue"]),a(d,{modelValue:e.title,"onUpdate:modelValue":t[1]||(t[1]=o=>e.title=o),label:"Title",required:"",class:"mb-4"},null,8,["modelValue"]),a(d,{modelValue:e.published_at,"onUpdate:modelValue":t[2]||(t[2]=o=>e.published_at=o),label:"Published Date",type:"date",required:"",class:"mb-4"},null,8,["modelValue"]),a(d,{modelValue:e.image_url,"onUpdate:modelValue":t[3]||(t[3]=o=>e.image_url=o),label:"Image URL",class:"mb-4"},null,8,["modelValue"]),C("div",Z,[t[7]||(t[7]=C("label",{class:"block font-medium mb-1"},"Content Paragraphs",-1)),(p(!0),V(F,null,N(e.content,(o,m)=>(p(),V("div",{key:m,class:"flex items-center gap-2 mb-2"},[a(A,{modelValue:e.content[m],"onUpdate:modelValue":y=>e.content[m]=y,"auto-grow":"",label:"Paragraph",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),a(c,{icon:"",variant:"text",color:"error",onClick:y=>e.content.splice(m,1)},{default:r(()=>[a(S,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]))),128)),a(c,{color:"secondary",variant:"tonal",size:"small",onClick:t[4]||(t[4]=o=>e.content.push(""))},{default:r(()=>t[6]||(t[6]=[i(" Add Paragraph ")])),_:1})])]),_:1})]),_:1}),a(R,null,{default:r(()=>[a(O),a(c,{text:"",onClick:t[5]||(t[5]=o=>E(_).push({name:"admin-articles"}))},{default:r(()=>t[8]||(t[8]=[i("Cancel")])),_:1}),a(c,{color:"primary",loading:n.value,onClick:g},{default:r(()=>t[9]||(t[9]=[i(" Save ")])),_:1},8,["loading"])]),_:1})]),_:1})])}}};export{de as default};
