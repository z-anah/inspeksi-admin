import{r as d,b3 as $,D as j,c as g,o as c,d as u,f as F,m as I,b as t,e as l,Z as m,t as i,v as V,Y as E,a1 as O}from"./index-C_Fo-Q1Z.js";import{s as _}from"./supabase-dF8vZqmp.js";import{V as x,b as D,c as L}from"./VCard-DIix0bcz.js";import{V as R}from"./VAlert-Cp-4rYs2.js";import{V as z}from"./VDataTable-Biu5DSsd.js";import{V as M}from"./VCardText-oi22yba3.js";import{V as Y}from"./VForm-BeUWgbEy.js";import{a as b}from"./VTextField-B25NbKOl.js";import{V as T}from"./VSpacer-_k1Z9FJN.js";import{V as U}from"./VDialog-BhUTdbvn.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VAvatar-C3GauEvc.js";import"./VImg-BUi6ipbq.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-JGcb-0Dy.js";import"./VDivider-Cl56lCsf.js";import"./VOverlay-D2VBwOt_.js";import"./VMenu-CKbpf5eF.js";import"./VChip-D-vlibiD.js";/* empty css              */const Z={class:"p-6"},G={class:"mb-8"},H={class:"text-xs text-gray-700"},J=["href"],K={key:1,class:"text-gray-400"},P={class:"text-xs text-gray-500"},_e={__name:"events",setup(Q){const r=d(!1),s=d(""),k=d([]),v=d(!1),p=d(!1),f=d(!1),o=$({id:null,title:"",event_date:"",location:"",map_url:""}),C=d(null),y=async()=>{r.value=!0,s.value="";const{data:n,error:e}=await _.from("events").select("*").order("event_date",{ascending:!1});e?s.value=e.message:k.value=n,r.value=!1},q=()=>{f.value=!1,Object.assign(o,{id:null,title:"",event_date:"",location:"",map_url:""}),v.value=!0},A=n=>{f.value=!0,Object.assign(o,n),v.value=!0},w=async()=>{if(!o.title||!o.event_date||!o.location){s.value="Title, Event Date, and Location are required";return}r.value=!0,s.value="";let n;f.value?n=await _.from("events").update({title:o.title,event_date:o.event_date,location:o.location,map_url:o.map_url}).eq("id",o.id).select():n=await _.from("events").insert([{title:o.title,event_date:o.event_date,location:o.location,map_url:o.map_url}]).select(),n.error?s.value=n.error.message:(v.value=!1,y()),r.value=!1},B=n=>{C.value=n,p.value=!0},N=async()=>{r.value=!0,s.value="";const{error:n}=await _.from("events").delete().eq("id",C.value);n&&(s.value=n.message),p.value=!1,y(),r.value=!1};return j(y),(n,e)=>(c(),g("div",Z,[u("div",G,[t(x,{flat:"",class:"py-6 px-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4 shadow-none border-b border-gray-200"},{default:l(()=>[e[9]||(e[9]=u("div",null,[u("h2",{class:"text-2xl font-bold mb-1"},"Events Management"),u("p",{class:"text-gray-500 text-base"}," Manage all events and their details for your website. ")],-1)),t(m,{color:"primary",class:"mt-4 md:mt-0",onClick:q,size:"large","prepend-icon":"tabler-plus"},{default:l(()=>e[8]||(e[8]=[i(" Add Event ")])),_:1})]),_:1})]),s.value?(c(),F(R,{key:0,type:"error",class:"mb-4"},{default:l(()=>[i(V(s.value),1)]),_:1})):I("",!0),t(z,{items:k.value,loading:r.value,class:"rounded-lg shadow",headers:[{title:"Title",key:"title"},{title:"Event Date",key:"event_date"},{title:"Location",key:"location"},{title:"Map URL",key:"map_url"},{title:"Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],"item-value":"id",density:"comfortable"},{"item.event_date":l(({item:a})=>[u("span",H,V(a.event_date),1)]),"item.map_url":l(({item:a})=>[a.map_url?(c(),g("a",{key:0,href:a.map_url,target:"_blank",class:"text-primary underline break-all"}," Map Link ",8,J)):(c(),g("span",K,"-"))]),"item.created_at":l(({item:a})=>[u("span",P,V(new Date(a.created_at).toLocaleString()),1)]),"item.actions":l(({item:a})=>[t(m,{icon:"",variant:"text",color:"primary",onClick:S=>A(a)},{default:l(()=>[t(E,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),t(m,{icon:"",variant:"text",color:"error",onClick:S=>B(a.id)},{default:l(()=>[t(E,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),"no-data":l(()=>e[10]||(e[10]=[u("div",{class:"text-center text-gray-400 py-8"},"No data.",-1)])),_:1},8,["items","loading"]),t(U,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=a=>v.value=a),"max-width":"500"},{default:l(()=>[t(x,null,{default:l(()=>[t(D,null,{default:l(()=>[i(V(f.value?"Edit Event":"Add Event"),1)]),_:1}),t(M,null,{default:l(()=>[t(Y,{onSubmit:O(w,["prevent"])},{default:l(()=>[t(b,{modelValue:o.title,"onUpdate:modelValue":e[0]||(e[0]=a=>o.title=a),label:"Title",required:"",class:"mb-4"},null,8,["modelValue"]),t(b,{modelValue:o.event_date,"onUpdate:modelValue":e[1]||(e[1]=a=>o.event_date=a),label:"Event Date",type:"date",required:"",class:"mb-4"},null,8,["modelValue"]),t(b,{modelValue:o.location,"onUpdate:modelValue":e[2]||(e[2]=a=>o.location=a),label:"Location",required:"",class:"mb-4"},null,8,["modelValue"]),t(b,{modelValue:o.map_url,"onUpdate:modelValue":e[3]||(e[3]=a=>o.map_url=a),label:"Map URL",class:"mb-4"},null,8,["modelValue"])]),_:1})]),_:1}),t(L,null,{default:l(()=>[t(T),t(m,{text:"",onClick:e[4]||(e[4]=a=>v.value=!1)},{default:l(()=>e[11]||(e[11]=[i("Cancel")])),_:1}),t(m,{color:"primary",loading:r.value,onClick:w},{default:l(()=>e[12]||(e[12]=[i(" Save ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(U,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value=a),"max-width":"400"},{default:l(()=>[t(x,null,{default:l(()=>[t(D,null,{default:l(()=>e[13]||(e[13]=[i("Delete Event?")])),_:1}),t(M,null,{default:l(()=>e[14]||(e[14]=[i(" Are you sure you want to delete this event? ")])),_:1}),t(L,null,{default:l(()=>[t(T),t(m,{text:"",onClick:e[6]||(e[6]=a=>p.value=!1)},{default:l(()=>e[15]||(e[15]=[i("Cancel")])),_:1}),t(m,{color:"error",loading:r.value,onClick:N},{default:l(()=>e[16]||(e[16]=[i(" Delete ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{_e as default};
