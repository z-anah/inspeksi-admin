import{r as n,aF as L,D as Y,c,o as u,d as i,f as Z,l as y,b as a,e as t,Z as p,s as d,t as V,Y as N,a1 as G}from"./index-qeOE-RZf.js";import{s as v}from"./supabase-530oTR8b.js";import{V as w,b as $,c as A}from"./VCard-DSA5d7tx.js";import{V as H}from"./VAlert-3engY8ay.js";import{V as J}from"./VDataTable-DIwuVEqw.js";import{V as E}from"./VCardText-esC-nFTL.js";import{V as K}from"./VForm-D3l-Nezn.js";import{b as I}from"./VTextField-l-OaS9z9.js";import{V as S}from"./VSpacer-_ceUCEQo.js";import{V as q}from"./VDialog-BTxMSAHY.js";import"./_commonjsHelpers-BosuxZz1.js";import"./VAvatar-CrC7-P1Q.js";import"./VImg-BuNpeMJc.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-dtqFoHiT.js";import"./ssrBoot-DzfblIhC.js";import"./VDivider-PwI-pKnj.js";import"./VOverlay-CG-9_lFx.js";import"./scopeId-Caf1NDu8.js";import"./lazy-DvqCi__j.js";import"./VMenu-BUbR1i_z.js";import"./VChip-D0U8pgGv.js";/* empty css              */const Q={class:"p-6"},R={class:"mb-8"},W=["src"],X={key:1,class:"text-gray-400"},ee={class:"text-xs text-gray-500"},ae={class:"mb-4"},te=["disabled"],le={key:0,class:"text-sm text-gray-500 mt-1"},oe={key:1,class:"text-sm text-red-500 mt-1"},se={key:2,class:"mt-2"},re=["src"],Ae={__name:"team-members",setup(ie){const M=n([]),m=n(!1),r=n(""),f=n(!1),g=n(!1),b=n(!1),o=L({id:null,name:"",position:"",image_url:""}),T=n(null),x=n(!1),_=n(""),k=async()=>{m.value=!0,r.value="";const{data:s,error:e}=await v.from("team_members").select("*").order("created_at",{ascending:!1});e?r.value=e.message:M.value=s,m.value=!1},B=()=>{b.value=!1,Object.assign(o,{id:null,name:"",position:"",image_url:""}),f.value=!0,r.value=""},h=s=>{b.value=!0,Object.assign(o,s),f.value=!0,r.value=""},U=async()=>{if(!o.name||!o.position){r.value="Name and Position are required";return}m.value=!0,r.value="";let s;b.value?s=await v.from("team_members").update({name:o.name,position:o.position,image_url:o.image_url}).eq("id",o.id).select():s=await v.from("team_members").insert([{name:o.name,position:o.position,image_url:o.image_url}]).select(),s.error?r.value=s.error.message:(f.value=!1,k()),m.value=!1},j=s=>{T.value=s,g.value=!0},P=async()=>{m.value=!0,r.value="";const{error:s}=await v.from("team_members").delete().eq("id",T.value);s&&(r.value=s.message),g.value=!1,k(),m.value=!1},F=async s=>{const e=s.target.files[0];if(e){x.value=!0,_.value="";try{const l=e.name.split(".").pop(),C=`team-member-${Date.now()}-${Math.random().toString(36).substring(2)}.${l}`,{data:O,error:D}=await v.storage.from("product-images").upload(C,e,{cacheControl:"3600",upsert:!1});if(D)throw D;const{data:z}=v.storage.from("product-images").getPublicUrl(O.path);o.image_url=z.publicUrl}catch(l){_.value=l.message||"Upload failed"}x.value=!1}};return Y(k),(s,e)=>(u(),c("div",Q,[i("div",R,[a(w,{flat:"",class:"py-6 px-8 flex flex-col md:flex-row md:items-center md:justify-between gap-4 shadow-none border-b border-gray-200"},{default:t(()=>[e[7]||(e[7]=i("div",null,[i("h2",{class:"text-2xl font-bold mb-1"},"Team Members Management"),i("p",{class:"text-gray-500 text-base"}," Manage all team members displayed on your website. ")],-1)),a(p,{color:"primary",class:"mt-4 md:mt-0",onClick:B,size:"large","prepend-icon":"tabler-plus"},{default:t(()=>e[6]||(e[6]=[d(" Add Team Member ")])),_:1})]),_:1})]),r.value?(u(),Z(H,{key:0,type:"error",class:"mb-4"},{default:t(()=>[d(V(r.value),1)]),_:1})):y("",!0),a(J,{items:M.value,loading:m.value,class:"rounded-lg shadow",headers:[{title:"Name",key:"name"},{title:"Position",key:"position"},{title:"Image",key:"image_url"},{title:"Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],"item-value":"id",density:"comfortable"},{"item.image_url":t(({item:l})=>[l.image_url?(u(),c("img",{key:0,src:l.image_url,alt:"team member",style:{height:"48px","max-width":"80px","object-fit":"cover","border-radius":"8px"}},null,8,W)):(u(),c("span",X,"-"))]),"item.created_at":t(({item:l})=>[i("span",ee,V(new Date(l.created_at).toLocaleString()),1)]),"item.actions":t(({item:l})=>[a(p,{icon:"",variant:"text",color:"primary",onClick:C=>h(l)},{default:t(()=>[a(N,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),a(p,{icon:"",variant:"text",color:"error",onClick:C=>j(l.id)},{default:t(()=>[a(N,{icon:"tabler-trash"})]),_:2},1032,["onClick"])]),"no-data":t(()=>e[8]||(e[8]=[i("div",{class:"text-center text-gray-400 py-8"},"No data.",-1)])),_:1},8,["items","loading"]),a(q,{modelValue:f.value,"onUpdate:modelValue":e[3]||(e[3]=l=>f.value=l),"max-width":"500"},{default:t(()=>[a(w,null,{default:t(()=>[a($,null,{default:t(()=>[d(V(b.value?"Edit Team Member":"Add Team Member"),1)]),_:1}),a(E,null,{default:t(()=>[a(K,{onSubmit:G(U,["prevent"])},{default:t(()=>[a(I,{modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.name=l),label:"Name",required:"",class:"mb-4"},null,8,["modelValue"]),a(I,{modelValue:o.position,"onUpdate:modelValue":e[1]||(e[1]=l=>o.position=l),label:"Position",required:"",class:"mb-4"},null,8,["modelValue"]),i("div",ae,[e[9]||(e[9]=i("label",{class:"block font-medium mb-1"},"Image",-1)),i("input",{type:"file",accept:"image/*",onChange:F,disabled:x.value},null,40,te),x.value?(u(),c("div",le,"Uploading...")):y("",!0),_.value?(u(),c("div",oe,V(_.value),1)):y("",!0),o.image_url?(u(),c("div",se,[i("img",{src:o.image_url,alt:"Team Member Image",style:{"max-width":"120px","max-height":"120px","border-radius":"8px"}},null,8,re)])):y("",!0)])]),_:1})]),_:1}),a(A,null,{default:t(()=>[a(S),a(p,{text:"",onClick:e[2]||(e[2]=l=>f.value=!1)},{default:t(()=>e[10]||(e[10]=[d("Cancel")])),_:1}),a(p,{color:"primary",loading:m.value,onClick:U},{default:t(()=>e[11]||(e[11]=[d(" Save ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(q,{modelValue:g.value,"onUpdate:modelValue":e[5]||(e[5]=l=>g.value=l),"max-width":"400"},{default:t(()=>[a(w,null,{default:t(()=>[a($,null,{default:t(()=>e[12]||(e[12]=[d("Delete Team Member?")])),_:1}),a(E,null,{default:t(()=>e[13]||(e[13]=[d(" Are you sure you want to delete this team member? ")])),_:1}),a(A,null,{default:t(()=>[a(S),a(p,{text:"",onClick:e[4]||(e[4]=l=>g.value=!1)},{default:t(()=>e[14]||(e[14]=[d("Cancel")])),_:1}),a(p,{color:"error",loading:m.value,onClick:P},{default:t(()=>e[15]||(e[15]=[d(" Delete ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{Ae as default};
